<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Hot or Not - Learnings</title>

    <meta name="description" content="">
    <meta name="author" content="Nikhil Verma">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- <link rel="stylesheet" href="css/reveal.min.css"> -->
    <link rel="stylesheet" href="css/theme/default.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
    if (window.location.search.match(/print-pdf/gi)) {
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'css/print/pdf.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    }
    </script>

    <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
</head>

<body id="body">

    <div class="reveal">

        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
            <section data-transition="concave" data-background="url(/img/background-blue.jpg)" data-background-size="cover" data-background-repeat="no-repeat">
                <h1>Making
                    <br/> <a target="_blank" href="https://m.hotornot.com/" class="hon-logo">Hot or Not</a>
                </h1>
                <h3>What we learned from building a complex web application</h3>
            </section>

            <section data-transition="concave">
                <section>
                    <h1>Brief History</h1>
                    <aside class="notes">
                        Hot or Not was launched in 2000 as a rating site. Had features like MeetMe and Hot Lists.
                    </aside>
                </section>

                <section>
                    <h2>2002</h2>
                    <img src="img/hotornot-first.png" class="stretch" alt="First release of Hot or Not" />
                </section>

                <section>
                    <h2>2010</h2>
                    <img src="img/hotornot-second.png" class="stretch" alt="Second release of Hot or Not" />
                </section>

                <section>
                    <h2>Relaunched in 2013 by Badoo for Mobile</h2>
                    <ul>
                        <li>Developed for mobile web</li>
                        <li>Used Cordova to release the native versions</li>
                    </ul>

                    <aside class="notes">
                        Needed to launch ASAP because of a competitior
                    </aside>
                </section>

                <section>
                    <img src="img/us-vs-them.png" class="stretch" />
                </section>
            </section>


            <section data-transition="concave">
                <section>
                    <h1>Native Wrappers</h1>
                    <span>Using Cordova/Phonegap</span>

                    <aside class="notes">
                        Explain what is cordova.
                        Why we needed it?
                        === Self contained app
                        === Wanted to hide the browser UI
                        === Self update like web
                    </aside>
                </section>

                <section>
                    <img src="/img/cordova-chart.png" class="stretch" />
                    <br/>
                    <small><a href="https://basicallydan.github.io/phonegap-not-so-bad-talk">@ Daniel Hough</a></small>

                    <aside class="notes">
                        Daniel mentioned that for a web developer who is short on time Phonegap is OK.
                        And we were. But Phonegap is not all that bad.
                    </aside>
                </section>

                <section>
                    <h2>Use Cordova/Phonegap</h2>
                    <ul>
                        <li class="fragment">Primarily want to get rid of the browser UI</li>
                        <li class="fragment">And you can perfect the wrapper</li>
                    </ul>
                    <aside class="notes">
                        Talk about wrapper incremental updates and it's slow speed when downloading manifest files.
                    </aside>
                </section>

                <section>
                    <h2>Problems</h2>
                    <ul>
                        <li class="fragment">Unreliable Push messaging and updating mechanism</li>
                        <li class="fragment">Subpar performance on Android WebView meant we needed a native app</li>
                    </ul>
                    <aside class="notes">
                        WebView performance meant a native android port was needed anyway. Stock android browser has changed now. to Chrome. But needs work. Cordova is dead. Long live Cordova
                    </aside>
                </section>
            </section>

            <section data-transition="concave">
                <section>
                    <h1>Mobile Web</h1>
                    <img src="/img/ios-safari.png" class="fragment icon" />
                    <img src="/img/google-chrome.png" class="fragment icon" />
                    <img src="/img/android-stock.png" class="fragment icon" />
                </section>

                <section>
                    <h2>Safari</h2>

                    <ul class="fragment clean">
                        <li class="fragment good">Best overall performance</li>
                        <li class="fragment bad">Harder to debug <sup>*</sup></li>
                        <li class="fragment bad">Lazy rendering issues</li>
                        <li class="fragment bad">Javascript bugs</li>
                    </ul>

                    <br/>
                    <br/>

                    <small class="fragment">* Use <a href="https://github.com/google/ios-webkit-debug-proxy">iOS Webkit Debug Proxy</a> to get around it</small>

                    <aside class="notes">
                        - Sleep/Wake bug
                    </aside>
                </section>

                <section>
                    <h2>Chrome</h2>

                    <ul class="fragment clean">
                        <li class="fragment good">Good overall performance</li>
                        <li class="fragment good">Best debugging experience</li>
                    </ul>
                </section>

                <section>
                    <h2>Stock Android</h2>

                    <ul class="fragment clean">
                        <li class="fragment bad">Laundry list of buggy behavior.</li>
                        <li class="fragment bad">Very common in the mobile web space.</li>
                        <li class="fragment bad">Hard to debug. Weinre helps but not by much.</li>
                    </ul>
                </section>

            </section>

            <section data-transition="concave">
                <section>
                    <h1>Performance</h1>

                    <h3>
                        <ul>
                            <li class="fragment">Scrolling</li>
                            <li class="fragment">Rendering</li>
                            <li class="fragment">DOM</li>
                            <li class="fragment">Caching</li>
                            <li class="fragment">Network</li>
                        </ul>
                    </h3>
                </section>

                <section>
                    <h2>Scrolling Performance</h2>
                </section>

                <section>
                    <p>General scrolling performance issues solved by using <a href="http://cubiq.org/iscroll-5">iScroll</a></p>
                </section>

                <section>
                    <div class="stretch has-side-video">
                        <video src="/img/janky-scrolling.mp4" autoplay loop muted controls></video>
                        <p>Scrolling performance can still suffer if too many elements exist</p>
                    </div>
                </section>

                <section>
                    <div class="stretch has-side-video">
                        <video src="/img/efficient-scrolling.mp4" autoplay loop muted controls></video>
                        <p>
                            It can be solved by unloading elements that have been scrolled away
                            <br/><br/>
                            <small>*Not exactly an apples to apples comparison</small>
                        </p>
                    </div>
                </section>

                <section>
                    <h2>Rendering Performance</h2>

                    <ul>
                        <li>Certain properties slower than other <sup>[1]</sup></li>
                        <li>3D transforms perform better than 2D transforms <sup>[2]</sup></li>
                    </ul>

                    <br/>
                    <br/>
                    <br/>

                    <small class="left">
                        <ol>
                            <li><a href="http://www.html5rocks.com/en/tutorials/speed/css-paint-times/">html5rocks.com/en/tutorials/speed/css-paint-times</a></li>
                            <li><a href="http://www.html5rocks.com/en/tutorials/speed/html5/">html5rocks.com/en/tutorials/speed/html5</a></li>
                        </ol>
                    </small>
                </section>

                <section>
                    <video class="stretch" src="/img/rendering-1.mp4" autoplay loop muted controls></video>
                </section>

                <section>
                    <video class="stretch" src="/img/rendering-2.mp4" autoplay loop muted controls></video>
                </section>

                <section>
                    <video class="stretch" src="/img/rendering-3.mp4" autoplay loop muted controls></video>
                </section>

                <section>
                    <h2>Improving Rendering Performance</h2>
                </section>

                <section>
                    <p>Avoid animating properties that cause reflows. Try to use their performant alternative.</p>

                    <table class="h3 fragment half centered">
                        <tr><td>Width</td><td>ScaleX</td></tr>
                        <tr><td>Height</td><td>ScaleY</td></tr>
                        <tr><td>Left</td><td>TranslateX</td></tr>
                        <tr><td>Top</td><td>TranslateY</td></tr>
                    </table>
                </section>

                <section>
                    <h3>Backface Visibilty</h3>

                    <div class="backface-container">
                        <div class="backface visible">
                            <pre>backface-visibiliy: visible</pre>
                        </div>

                        <div class="backface hidden">
                            <pre>backface-visibiliy: hidden</pre>
                        </div>
                    </div>
                </section>

                <section>
                    <p>If you don't need to flip a 3D object, <br/> using backface-visibility is always better for performance</p>
                    <br/>
                </section>

                <section>
                    <p>Order of CSS properties matters and can be used to our advantage.</p>
                    <pre><code class="stretch" data-trim contenteditable>
div {
    // Scale it down
    position: absolute;
    top: 0;
    left: 0;
    width: 20%;
    height: 20%;

    // Blur it
    .Filter(blur(3px));

    // Scale it up
    .transform(translateZ(0) scale(5));
}
                    </code></pre>

                    <small><a href="https://medium.com/what-i-learned-building/4364221d6d97">medium.com/what-i-learned-building/4364221d6d97</a></small>
                </section>

                <section>
                    <h2>Problems</h2>

                    <ul>
                        <li>CSS filter performance is bad on Android. Even on Chrome.</li>
                        <li>3D objects eat GPU memory proportional to their size.</li>
                    </ul>
                </section>

                <section>
                    <h2>DOM Performance</h2>

                    <ul>
                        <li>Lazy load elements if you can</li>
                        <li>Render offscreen</li>
                    </ul>
                </section>

                <section>
                    <h2>Storage Performance</h2>

                    <ul>
                        <li>LocalStorage is blocking and proportional to the stored data.</li>
                        <li>Read everything at the app boot in memory. Write rarely.</li>
                    </ul>
                </section>

                <section>
                    <h2>Network Performance</h2>
                    <p>Mobile networks have high latency, but decent speeds</p>
                    <br/>
                    <ul>
                        <li>Bigger files and smaller numbers help.</li>
                        <li>Use analytics to track loading of resources.</li>
                        <li>Use sprites <sup>[1]</sup></li>
                        <li>Minify JS</li>
                    </ul>

                    <br/>
                    <br/>
                    <br/>

                    <small>[1] - <a href="https://github.com/Ensighten/spritesmith">SpriteSmith</a></small>
                </section>
            </section>

            <section>
                <h1>Thanks!</h1>
                <p>
                    <small><a href="http://nikhil-verma.com">Nikhil Verma</a> / <a href="http://twitter.com/NikhilVerma">@NikhilVerma</a></small>
                </p>
            </section>
        </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
    // Full list of configuration options available here:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,
        transitionSpeed: 'fast',

        width: window.innerWidth,
        height: window.innerHeight,

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // Parallax scrolling
        // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
        // parallaxBackgroundSize: '2100px 900px',

        // Optional libraries used to extend on reveal.js
        dependencies: [{
            src: 'lib/js/classList.js',
            condition: function() {
                return !document.body.classList;
            }
        }, {
            src: 'plugin/markdown/marked.js',
            condition: function() {
                return !!document.querySelector('[data-markdown]');
            }
        }, {
            src: 'plugin/markdown/markdown.js',
            condition: function() {
                return !!document.querySelector('[data-markdown]');
            }
        }, {
            src: 'plugin/highlight/highlight.js',
            async: true,
            callback: function() {
                hljs.initHighlightingOnLoad();
            }
        }, {
            src: 'plugin/zoom-js/zoom.js',
            async: true,
            condition: function() {
                return !!document.body.classList;
            }
        }, {
            src: 'plugin/notes/notes.js',
            async: true,
            condition: function() {
                return !!document.body.classList;
            }
        }]
    });
    </script>

</body>

</html>